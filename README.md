# 遥遥领先的阿瓦隆系统

你可能遇到过一种情景，你明明**重复发送了很多次弹幕**，而且你也亲眼看到了弹幕**发送成功**在屏幕上显示，但是**主播就是不对你的弹幕有所回复**，哪怕是**没几个人的小主播**直播间。  

你是否怀疑，这里是不是也介入了阿瓦隆系统自动删评，就像优秀的仅自己可见shadowban一样。  

真实情况是，**你的弹幕在发送的时候就已经被删除了**，**除了你**正在观看直播的设备显示了这条自欺欺人的弹幕，**没有任何人能看到你发出的弹幕**，你翻来覆去也想不明白，最后只想到**评论区最常见的四个字**  ————

**发送成功**  

没想到吧，这种自欺欺人的**仅自己可见**，**直播间也有！**

不过不用担心，**道高一尺魔高一丈**，这个脚本可以完美地解决这个痛点。

# 弹幕反诈脚本

这是一个用于拦截和处理发送到 Bilibili 直播间的弹幕请求的脚本。它可以**检测弹幕发送**并在屏幕上显示相应的提示信息。提示你在直播间发送的**弹幕是否被秒删**，**被什么秒删**，有助于用户规避河蟹词，**避免看似发了弹幕结果主播根本看不到**，不被发送成功的谎言所欺骗！  

脚本修改自 TGSAN-哔哩哔哩直播弹幕反诈 ，增添了主播屏蔽弹幕发送失败时的相关信息提示，提示信息更加人性化。  

https://greasyfork.org/zh-CN/scripts/488621-哔哩哔哩直播弹幕反诈。

## 功能

- 拦截发送到 `api.live.bilibili.com/msg/send` 的请求。
- 根据服务器返回的信息，判断弹幕是否发送失败，如果发送成功，则提示发送成功（**可在代码中关闭此回调**）。
- 在弹幕发送失败时，在屏幕上显示提示信息（**仅在全屏模式生效**）。
- 弹幕从左侧固定位置开始向右滚动，被**主播**吃掉为**蓝色**，被**系统**吃掉为**绿色**。可修改代码实现自定义颜色，支持16进制颜色代码和颜色名称。
- 支持自定义弹幕。
- **重要提示！！！系统权限高于主播**，当出现河蟹关键词时**系统会优先删除**，即便主播设置了系统同样的关键词。

## 效果展示

- (示例效果，弹幕内容及颜色可自定义)
- 被系统吃掉
- ![image](https://github.com/user-attachments/assets/c89ed114-d547-4d00-acc4-19cdfcff5856)
- 被主播吃掉
- ![image](https://github.com/user-attachments/assets/a5021dd9-e6b9-4b48-af44-510f03be1134)
- 全屏情况下显示效果
- ![image](https://github.com/user-attachments/assets/f970511a-3d1a-4acf-9522-5d8c139663ec)


## 使用方法

1. 确保您使用的是支持用户脚本的浏览器扩展（如 Tampermonkey 或 Greasemonkey）。
2. 将脚本添加到您的用户脚本管理器中。
3. 访问 Bilibili 直播间，脚本将自动运行。
4. 待直播间加载完毕后，弹幕容器会提示脚本加载成功。
5. 发送弹幕，根据回调信息判断是否发送成功

## 代码说明

- **窗口上下文**: 检测是否可以使用 `unsafeWindow` 来访问页面的 `window` 对象，如果可以，则完成脚本加载，否则弹出错误信息。
- **拦截请求**: 重写 `fetch` 函数以拦截特定的请求，用于检测弹幕是否发送成功。
- **显示信息**: 使用固定位置的 `div` 元素在屏幕上显示消息，并通过 `requestAnimationFrame` 实现从左到右的滚动效果。

## 自定义提示

- **滚动速度**: 可以通过调整 `showFloatingMessage` 函数中的 `speed` 变量来改变弹幕滚动速度。
- **消息内容和颜色**: 在 `showFloatingMessage` 函数中修改 `message` 和 `color` 参数以自定义显示内容。
- **弹幕字号**: 同上，详见代码注释。
- **起始位置**: 同上，详见代码注释。
- **重复次数**: 同上，详见代码注释。

## 注意事项

- 本脚本仅用于学习目的，请勿用于非法用途。
- 使用本脚本可能会违反某些网站的使用条款，请谨慎使用。

## 贡献

欢迎提交问题和建议！如果您有改进的想法，请随时提 PR 或 issue。

## 许可证

本项目采用 GPL 3.0 许可证。
